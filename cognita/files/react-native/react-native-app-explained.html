<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>React Native App Explained</title>
    <link rel="stylesheet" href="../../style.css">
    <script src="../../index.js"></script>
</head>
<body>
    <header>
        <nav class="corporate-nav">
            <div class="nav-container">
                <div class="title-header">
                    <h1 class="title">React Native App Explained</h1>
                    <p class="subtitle">In a React Native app, the index.js file is the main entry point of your application. It's where your app is bootstrapped (i.e., launched and registered) so that the React Native runtime knows which component to render first when the app starts.</p>
                </div>        
            </div>
        </nav>
    </header>

    <main>
        <section>
            <h2>Where is index.js located?</h2>
            <p>It‚Äôs usually found at the root of your React Native project, alongside other files like:</p>
        
            <pre><code>
myApp/
‚îú‚îÄ‚îÄ App.js
‚îú‚îÄ‚îÄ index.js   üëà main entry file
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ app.json
‚îú‚îÄ‚îÄ ...
            </code></pre>

            <p>What does index.js do?</p>
            <p>üß† Here‚Äôs a breakdown of a typical index.js:</p>

            <pre><code>
import { AppRegistry } from 'react-native'; // From React Native core
import App from './App'; // Your main app component
import { name as appName } from './app.json'; // Gets the app name

AppRegistry.registerComponent(appName, () => App); // Registers the root component
            </code></pre>

            <p>üîç Let's explain:</p>
            <ul>
                <li>AppRegistry.registerComponent(...):
                    <p>Tells React Native which component (App) to start rendering first.</p>
                </li>
                <li>
                    App:
                    <p>This is your main application component, usually defined in App.js.</p>
                </li>
                <li>
                    appName:
                    <p>The name of your app, defined in app.json, e.g.,:</p>
                    <pre><code>
{
    "name": "MyAwesomeApp"
}  
                    </code></pre>
                </li>
            </ul>
        </section>

        <section>
            <h2>üèÅ When is index.js used?</h2>
            <p>When the app starts (whether on a real device or emulator), React Native looks at index.js to launch your app. Without this file or a proper AppRegistry setup, your app won‚Äôt run.</p>
            <p>üõ†Ô∏è Example Use Cases Beyond Basic Setup</p>
            <p>You can also do other global setups here, such as:</p>
            <ul>
                <li>Setting up Firebase background message handlers</li>
                <li>Initializing error tracking (e.g., Sentry)</li>
                <li>Registering custom components</li>
                <li>Configuring themes or app-wide settings</li>
            </ul>
        </section>

        <section>
            <h2>‚úÖ Summary</h2>
            <table>
                <thead>
                    <tr>
                        <th>Purpose</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Main Entry Point</td>
                        <td>Launches your React Native app</td>
                    </tr>
                    <tr>
                        <td>Registers App</td>
                        <td>Tells React Native which component to render</td>
                    </tr>
                    <tr>
                        <td>Setup Global Configs</td>
                        <td>Useful for notifications, error logging, etc.</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section>
            <p>Great! Let‚Äôs dive into the difference and relationship between index.js and App.js in a React Native project, and how index.js fits into the bigger picture with native Android/iOS code.</p>
            <h2>1. Difference between index.js and App.js</h2>
            <table>
                <thead>
                    <tr>
                        <th>File</th>
                        <th>Purpose</th>
                        <th>Contents</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>index.js</td>
                        <td>Entry point of the app. Registers the root component with React Native.</td>
                        <td>Usually minimal: imports App and registers it with AppRegistry.</td>
                    </tr>
                    <tr>
                        <td>App.js</td>
                        <td>Main app component. Contains the core UI and app logic.</td>
                        <td>Your app‚Äôs screens, navigation, components, styles, and business logic live here.</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section>
            <h2>Example:</h2>
            <p>index.js</p>
            <pre><code>
import { AppRegistry } from 'react-native';
import App from './App';
import { name as appName } from './app.json';

AppRegistry.registerComponent(appName, () => App);
            </code></pre>

            <ul>
                <li>Only job: register App as the root component.</li>
                <li>This tells React Native: "When you start the app, render the App component first."</li>
            </ul>

            <p>App.js</p>
            <pre><code>
import React from 'react';
import { View, Text } from 'react-native';

const App = () => {
  return (
    &lt;View&gt;
      &lt;Text&gt;Hello, React Native!&lt;/Text&gt;
    &lt;/View&gt;
  );
};

export default App;
            </code></pre>

            <ul>
                <li>Contains your actual UI.</li>
                <li>Can include navigation, API calls, state management, and so on.</li>
            </ul>
        </section>

        <section>
            <h2>2. How index.js ties into Native Android/iOS code</h2>
            <p>React Native bridges JavaScript and native (Java/Objective-C/Swift) layers.</p>
            <ul>
                <li>
                    Native side (Android/iOS) handles:
                    <ul>
                        <li>App lifecycle</li>
                        <li>Permissions</li>
                        <li>Native UI components</li>
                        <li>Push notifications</li>
                        <li>Device-specific functionality</li>
                    </ul>
                </li>

                <li>
                    JavaScript side (React Native) handles:
                    <ul>
                        <li>UI layout using React components</li>
                        <li>Business logic</li>
                        <li>State management</li>
                        <li>Network requests</li>
                    </ul>
                </li>

                <li>
                    What happens on app launch:
                    <ol>
                        <li>Native code boots up first (Android's MainActivity.java, iOS's AppDelegate.m).</li>
                        <li>Native code initializes the React Native bridge.</li>
                        <li>The bridge loads the JavaScript bundle, starting execution from index.js.</li>
                        <li>index.js registers the root React component (App).</li>
                        <li>React Native renders App and its child components.</li>
                    </ol>
                </li>

                <p>Diagram to visualize:</p>
                <pre><code>
[Native Layer (Android/iOS)] 
       ‚Üì initializes bridge ‚Üì
[React Native Bridge (JS Engine)]
       ‚Üì runs JS starting at ‚Üì
[index.js] ‚Üí registers root component ‚Üí renders ‚Üí [App.js and children]
                </code></pre>
            </ul>
        </section>

        <section>
            <h2>3. Summary</h2>
            <table>
                <thead>
                    <tr>
                        <th>Step</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Native launch</td>
                        <td>Android/iOS native code starts first</td>
                    </tr>
                    <tr>
                        <td>React Native bridge init</td>
                        <td>Bridge between native and JS initializes</td>
                    </tr>
                    <tr>
                        <td>JS bundle loads</td>
                        <td>JS engine loads your JS code starting at index.js</td>
                    </tr>
                    <tr>
                        <td>index.js registers root</td>
                        <td>Registers root React component (App)</td>
                    </tr>
                    <tr>
                        <td>React Native renders UI</td>
                        <td>App.js and its components render UI</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section>
            <p>If you want, I can also explain:</p>
            <ul>
                <li>How native files like MainActivity.java and AppDelegate.m relate to React Native.</li>
                <li>How to hook into native lifecycle or events from JS.</li>
                <li>How to debug this flow when the app doesn't load.</li>
            </ul>
        </section>

        <section>
            <p>index.js</p>
            <pre><code>
/**
 * @format
 */

import {AppRegistry} from 'react-native';
import App from './App';
import {name as appName} from './app.json';
import messaging from '@react-native-firebase/messaging';

messaging().setBackgroundMessageHandler(async remoteMessage => {
  console.log('Message handled in the background!', remoteMessage);
});

AppRegistry.registerComponent(appName, () => App);
            </code></pre>

            <p>You're sharing the content of your index.js file for a React Native project that uses Firebase Cloud Messaging (FCM) via @react-native-firebase/messaging.</p>
            <p>Here's a quick review and explanation of what this file is doing:</p>

            <p>‚úÖ Breakdown</p>
            <pre><code>
import {AppRegistry} from 'react-native';
import App from './App';
import {name as appName} from './app.json';
import messaging from '@react-native-firebase/messaging';
            </code></pre>

            <ul>
                <li>AppRegistry: Used to register the main application component.</li>
                <li>App: Your main application component.</li>
                <li>appName: The app's name from app.json.</li>
                <li>messaging: The Firebase messaging module for handling push notifications.</li>
            </ul>
        </section>

        <section>
            <h2>‚úÖ Background Message Handler</h2>
            <pre><code>
messaging().setBackgroundMessageHandler(async remoteMessage => {
    console.log('Message handled in the background!', remoteMessage);
});                  
            </code></pre>

            <ul>
                <li>This sets a background message handler for Firebase messages.</li>
                <li>It's required for handling messages when the app is in the background or terminated.</li>
                <li>This only works on Android, as iOS does not support background message handlers in the same way.</li>
            </ul>
        </section>

        <section>
            <h2>‚úÖ Register Main App Component</h2>
            <pre><code>
AppRegistry.registerComponent(appName, () => App);
            </code></pre>
            <p>This registers your root component (App) so React Native knows where to start the app.</p>
        </section>

        <section>
            <p>You're referencing this piece of code:</p>
            <pre><code>
messaging().setBackgroundMessageHandler(async remoteMessage => {
    console.log('Message handled in the background!', remoteMessage);
});                
            </code></pre>

            <p>This code is typically used in React Native with Firebase Cloud Messaging (FCM) via the @react-native-firebase/messaging library. It sets up a handler for background messages‚Äîthose received when the app is in the background or terminated.</p>

            <p>Important Context (as of recent versions of @react-native-firebase/messaging):</p>
            <ul>
                <li>setBackgroundMessageHandler is only needed on the JS side in combination with a proper Headless JS task registered in Android.</li>
                <li>On iOS, background/terminated notifications need to be handled via APNs with appropriate configuration (and cannot run background JS like Android can).</li>
                <li>This function is deprecated in recent versions and no longer necessary or recommended.</li>
            </ul>
        </section>

        <section>
            <h2>‚úÖ Modern Usage</h2>
            <p>If you're using a recent version of @react-native-firebase/messaging, the correct way to handle background messages is via firebase.messaging().setBackgroundMessageHandler in a separate JS file registered for Headless JS (on Android).</p>
            <p>Example Setup:</p>
            <ol>
                <li>
                    Create a new file (e.g., firebase-messaging.js) in the root of your project:
                    <pre><code>
// firebase-messaging.js

import messaging from '@react-native-firebase/messaging';

messaging().setBackgroundMessageHandler(async remoteMessage => {
  console.log('Message handled in the background!', remoteMessage);
});
                    </code></pre>
                </li>

                <li>
                    Register this file in your index.js or App.js:
                    <pre><code>
&lt;service
  android:name="io.invertase.firebase.messaging.ReactNativeFirebaseMessagingService"
  android:exported="true"&gt;
  &lt;intent-filter&gt;
    &lt;action android:name="com.google.firebase.MESSAGING_EVENT" /&gt;
  &lt;/intent-filter&gt;
&lt;/service&gt;
                    </code></pre>
                </li>
            </ol>
        </section>

        <section>
            <h2>üî• Notes</h2>
            <ul>
                <li>
                    If this function isn't working:
                    <ul>
                        <li>Ensure you‚Äôve requested and been granted notification permissions.</li>
                        <li>Ensure that background data is allowed and battery optimization is not interfering.</li>
                        <li>Check Android logs (e.g., with adb logcat) for clues.</li>
                        <li>Check that your message type is data message, not notification message, since only data messages are delivered to background handlers.</li>
                    </ul>
                </li>
            </ul>
        </section>
    </main>

    <footer>
        <p class="copyright">
            &copy; <span id="year"></span> Aether Corp. All rights reserved.
        </p>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Aether Neuri</title>
  <link rel="stylesheet" href="neuri.css" />
</head>
<body>
  <div class="container">
    <div class="header">
        <link rel="icon" type="image/x-icon" href="../assets/favicon.ico">
      <img src="../assets/aether-logo.png" alt="Aether Logo" />
      <h1>Aether Neuri</h1>
    </div>

    <input type="text" id="search" placeholder="Search Aether Neuri..." />

    <label>
      <input type="checkbox" id="groupToggle" />
      Group by category
    </label>

    <main>
      <ul id="page-list"></ul>
    </main>
  </div>

  <script>
    // Dynamically get base path (e.g., '/neuri/' or '/' for localhost)
    const pathParts = window.location.pathname.split('/');
    const repoName = pathParts[1] || '';
    const isGitHubPages = window.location.hostname.includes('github.io');
    const basePath = isGitHubPages ? `/${repoName}/neuri/` : './';

    // Raw paths relative to basePath
    const htmlFiles = [
      "files/automation/automating-forms.html",
      "files/automation/CAPTCHAs.html",
      "files/automation/intelligent-document-processing.html",
      "files/automation/recommendation-systems.html",
      "files/cs/docx.html",
      "files/cs/how-filesystems-work.html",
      "files/cs/singleton-pattern.html",
      "files/cs/what-is-a-tree.html",
      "files/cs/xml-usage.html",
      "files/database/mongodb-embedded-documents-or-manual-references.html",
      "files/database/mongodb-vs-sql-database.html",
      "files/networking/core-nfc-framework.html",
      "files/networking/firebase-cloud-messaging.html",
      "files/networking/hosting-a-website.html",
      "files/networking/how-a-device-connects-to-a-network.html",
      "files/networking/mobile-payment.html",
      "files/networking/modem.html",
      "files/networking/near-field-communication-NFC-tap-and-play.html",
      "files/networking/near-field-communication.html",
      "files/networking/network-interfaces.html",
      "files/networking/physical-wired-connection.html",
      "files/networking/push-notifications-improve-engagement-in-a-contact-management-app.html",
      "files/networking/SSL-Pinning.html",
      "files/networking/what-is-xml.html",
      "files/python/python-basic-concepts-to-begin-with.html",
      "files/python/python-lambda-functions.html",
    ];

    const htmlFilesWithBase = htmlFiles.map(file => basePath + file);

    htmlFilesWithBase.sort((a, b) => {
      const nameA = a.split("/").pop().toLowerCase();
      const nameB = b.split("/").pop().toLowerCase();
      return nameA.localeCompare(nameB);
    });

    const searchInput = document.getElementById('search');
    const groupToggle = document.getElementById('groupToggle');
    const listElement = document.getElementById('page-list');

    function getDisplayName(filename) {
      const cleanName = filename.replace('.html', '');
      const words = cleanName.split('-');
      const capitalizedWords = words.map(word =>
        word.charAt(0).toUpperCase() + word.slice(1)
      );
      return capitalizedWords.join(' ');
    }

    function groupFiles(files) {
      const grouped = {};
      files.forEach(file => {
        const parts = file.replace(basePath, '').split('/');
        const folder = parts[1]; // e.g., 'network'
        if (!grouped[folder]) grouped[folder] = [];
        grouped[folder].push(file);
      });
      return grouped;
    }

    function displayList(files, grouped) {
      listElement.innerHTML = '';

      if (grouped) {
        const groupedFiles = groupFiles(files);
        for (const [folder, fileList] of Object.entries(groupedFiles)) {
          const section = document.createElement('section');
          const heading = document.createElement('h2');
          heading.textContent = folder.charAt(0).toUpperCase() + folder.slice(1);
          section.appendChild(heading);

          const ul = document.createElement('ul');
          fileList.forEach(file => {
            const li = document.createElement('li');
            const link = document.createElement('a');
            link.href = file;
            link.textContent = getDisplayName(file.split('/').pop());
            li.appendChild(link);
            ul.appendChild(li);
          });

          section.appendChild(ul);
          listElement.appendChild(section);
        }
      } else {
        files.forEach(file => {
          const li = document.createElement('li');
          const link = document.createElement('a');
          link.href = file;
          link.textContent = getDisplayName(file.split('/').pop());
          li.appendChild(link);
          listElement.appendChild(li);
        });
      }

      if (files.length === 0) {
        listElement.innerHTML = '<li>No results found.</li>';
      }
    }

    // Initial render
    displayList(htmlFilesWithBase, groupToggle.checked);

    // Search input event
    searchInput.addEventListener('input', () => {
      const query = searchInput.value.toLowerCase();
      const filtered = htmlFilesWithBase.filter(file => file.toLowerCase().includes(query));
      displayList(filtered, groupToggle.checked);
    });

    // Group toggle event
    groupToggle.addEventListener('change', () => {
      const query = searchInput.value.toLowerCase();
      const filtered = htmlFilesWithBase.filter(file => file.toLowerCase().includes(query));
      displayList(filtered, groupToggle.checked);
    });
  </script>
</body>
</html>
